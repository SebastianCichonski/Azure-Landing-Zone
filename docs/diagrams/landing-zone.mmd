flowchart TB
  A["Tenant / Entra ID"] --> S["Subscription: <project>-<env> (Azure Landing Zone)"]

  subgraph S["Subscription: <project>-<env> (Azure Landing Zone)"]
    direction TB

    subgraph MON["rg-alz-*-monitor"]
      LA["Log Analytics Workspace"]
      AM["Azure Monitor (Alerts/Action Groups)"]
    end

    subgraph SH["rg-alz-*-shared"]
      KV["Key Vault"]
      MI["Managed Identities"]
      KV --- MI
    end

    subgraph WL["rg-alz-*-workloads"]
      RES["Test resources (VM/App/Storage/...)"]
      DIAG["Diagnostic settings on resources"]
      RES --> DIAG
    end

    DIAG --> LA
    RES -. "auth via MI" .-> MI
    RES -. "secrets/certs" .-> KV
    AM --> LA
  end

  P["Azure Policy / Initiatives"] -.-> S
  R["RBAC (roles + groups)"] -.-> S
